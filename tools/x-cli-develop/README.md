<a id="onboarding-quick-links"></a>
<a id="log-replay-diff"></a>
<a id="container-usage"></a># x-cli ΓÇö Cross-Platform Test/Replay CLI  [![Onboarding Check](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/onboarding-check.yml/badge.svg)](./.github/workflows/onboarding-check.yml) [![Onboarding Quick Links](https://img.shields.io/badge/Onboarding-Quick%20Links-2ea44f)](#onboarding-quick-links) [![Token Diagnostics](https://img.shields.io/badge/Token%20Diagnostics-Docs-2ea44f)](docs/ci-helpers.md#token-diagnostics-composite) [![Telemetry CLI](https://img.shields.io/badge/Telemetry%20CLI-Docs-2ea44f)](docs/cli/telemetry.md) [![Stage 1 Telemetry](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/stage1-telemetry.yml/badge.svg)](./.github/workflows/stage1-telemetry.yml) [![Enable debug_token_info](https://img.shields.io/badge/Stage%201-enable%20debug_token_info-2ea44f)](docs/ci-helpers.md#token-diagnostics-composite) [![Telemetry Tests](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/telemetry-tests.yml/badge.svg)](./.github/workflows/telemetry-tests.yml)  x-cli is a small, self-contained CLI for exercising test scenarios and replaying historical workflow logs. It ships with simple demo subcommands (echo, reverse, upper), JSON logging, and two analysis tools: log-replay (verbatim stream/timing) and log-diff (timing deltas).  Quick links: [SRS index](docs/SRS.md), [Design](docs/Design.md), [Log Replay & Diff](#log-replay-diff), [Container Usage](#container-usage), [Telemetry CLI](docs/cli/telemetry.md), [Token Diagnostics](docs/ci-helpers.md#token-diagnostics-composite), [Node Tooling Patterns](docs/ci/node-patterns.md). Also see [ghops JSON Schemas](docs/schemas/ghops-logs.md) and the summary tool `scripts/ghops/tools/all-logs-summary.ps1`.  > External Actions Notice > Composite GitHub Actions for PR comments and artifacts metadata are hosted in dedicated repos. Use these external actions and their docs going forward: > - Post PR Comment (labelΓÇægated): https://github.com/LabVIEW-Community-CI-CD/gha-post-pr-comment > - Load Artifacts Metadata: https://github.com/LabVIEW-Community-CI-CD/gha-artifacts-metadata > Local copies under `.github/actions/` will be removed after all references are updated.  ## Quick Start  - Build: `dotnet build XCli.sln -c Release` - Test:  `dotnet test  XCli.sln -c Release` - Help:  `dotnet run --project src/XCli/XCli.csproj -- --help` - Version: `dotnet run --project src/XCli/XCli.csproj -- --version`  Examples - Echo:   `dotnet run --project src/XCli/XCli.csproj -- echo "hello"` - Upper:  `dotnet run --project src/XCli/XCli.csproj -- upper "abc"` - Reverse:`dotnet run --project src/XCli/XCli.csproj -- reverse "abc"`  ## Getting Started  First time? Run `make first-run` to set up a local token, authenticate gh, and persist `.tools/bin` on PATH; then open a new terminal.  ## Onboarding - Quick Links  - First run: `make first-run` (sets up token, gh auth, and persists `.tools/bin` on PATH). - Token helper:   - Windows: `scripts/ghops/tools/use-local-github-token.ps1` (use `-Login -Validate [-EnsureGh]`)   - Linux/macOS: `scripts/ghops/tools/use-local-github-token.sh` (`--login --validate`) - PATH bootstrap (persistent):   - Windows: `scripts/ghops/tools/bootstrap-path.ps1` (`-AllHosts -WindowsPowerShell [-EchoOnce]`)   - Linux/macOS: `scripts/ghops/tools/bootstrap-path.sh` (`[--echo-once]`) - CI workflow: [Onboarding Check](.github/workflows/onboarding-check.yml)  ## User OAuth (Device Flow)  - Mint a user-scoped token with GitHubΓÇÖs Device Flow and store it for local tools:   - `python scripts/auth_device.py --client-id <your_app_client_id> --scope repo,workflow`   - Defaults: writes `.secrets/github_user_token.txt` and, when available, saves to the OS keyring under service `x-cli`, account `github_user_token`.   - Use `--no-keyring` to skip keyring storage. - Token preference order for helper scripts:   - `GITHUB_USER_TOKEN` env ΓåÆ OS keyring (`x-cli`/`github_user_token`) ΓåÆ `.secrets/github_user_token.txt` ΓåÆ `GITHUB_TOKEN`/`GH_TOKEN`. - Load tokens into your shell session:   - POSIX: `. scripts/load_github_token.sh`   - PowerShell: `. scripts/load_github_token.ps1`  ## Token Diagnostics in CI  - Stage 1 Telemetry supports a debug flag to capture and upload masked token info. - Enable in the Actions UI: Actions ΓåÆ Stage 1 Telemetry ΓåÆ Run workflow ΓåÆ set `debug_token_info` to true. - Enable from another workflow call:   ```yaml   jobs:     call-stage1:       uses: ./.github/workflows/stage1-telemetry.yml       with:         debug_token_info: true   ``` - Global toggle: set repo variable `DEBUG_TOKEN_INFO=1` (Actions ΓåÆ Variables) to enable across Stage 1/2/3 debug gates. - Artifacts: `token-info-stage1` (JSON). Job Summary prints masked fields: found/kind/source/length/preview.  ## Telemetry Validation in CI  - Stage 1 supports schema validation of telemetry artifacts behind a toggle. - Enable via workflow dispatch input `validate_schema: true`, or set repo variable `VALIDATE_TELEMETRY_SCHEMA=1`. - Validates:   - Summary against `docs/schemas/v1/telemetry.summary.v1.schema.json`   - Events (JSONL) against `docs/schemas/v1/telemetry.events.v1.schema.json` - Locally, set `QA_VALIDATE_SCHEMA=1` to run the same checks during `scripts/qa.ps1`.  ## QA Run (Local)  - Windows: `pwsh ./scripts/qa.ps1` - POSIX: `./scripts/qa.sh` - Defaults: runs tests serially to avoid cross-test interference.   - Enable parallel: `QA_ENABLE_PARALLEL=1 pwsh ./scripts/qa.ps1`   - Force serial explicitly: `pwsh ./scripts/qa.ps1 -NoParallel`  ## Agent Bootstrap  Before editing workflows or running release tasks, standardize your environment:  ```bash ./scripts/agent_bootstrap_gitflow.sh ```  On Windows PowerShell:  ```powershell pwsh scripts/agent_bootstrap_gitflow.ps1 ```  The scripts ensure GitFlow branches exist, remotes point to `LabVIEW-Community-CI-CD/x-cli`, PowerShell 7 is available, and required secrets are present. See `docs/AGENT_BOOTSTRAP.md` for details.  ## Hooks  - POSIX: `make hooks` (installs hooks via `scripts/hooks-install.sh`) - Windows: `scripts/setup-git-hooks.ps1` (installs Windows-friendly .bat wrappers)  Optional: set `TELEMETRY_USE_LOCAL_TIME=1` to record local system time in QA/telemetry; default is UTC.  Source of truth for pre-commit hook docs links lives in `scripts/precommit_hook_links.json`. When adding new hooks to `.pre-commit-config.yaml`, also add an entry in that JSON so PR comments can hyperlink failing hooks to the right documentation.  ## Standards Appendix  [![PR Coverage Gate](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/coverage-gate.yml/badge.svg?branch=main)](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/coverage-gate.yml)  -   [Standards ΓÇö Edition Appendix](docs/compliance/Standards-Edition-Appendix.md) -   [Standards Crosswalk](docs/compliance/Standards-Crosswalk.md) -   [Glossary & Synonyms](docs/compliance/Glossary-Synonyms.md) -   [Definition of Done (DoD) & Exit Criteria](docs/compliance/DoD-Exit-Criteria.md) -   **PR Reviewer Checklist ΓÇö DoD**: [docs/compliance/PR-Reviewer-Checklist.md](docs/compliance/PR-Reviewer-Checklist.md)  *   -   **PR Reviewer OneΓÇæSlide (DoD)**: [docs/compliance/PR-Reviewer-OneSlide.md](docs/compliance/PR-Reviewer-OneSlide.md)  ## Docs ΓÇö quick linkS  -   Standards: [StandardsΓÇæCrosswalk](docs/compliance/Standards-Crosswalk.md) -   Crosswalk Matrix: [Matrix (repoΓÇæauthored)](docs/compliance/Standards-Crosswalk-Matrix.md) -   Edition pins: [Edition Appendix](docs/compliance/Standards-Edition-Appendix.md) -   Citation rules: [Standards Citation Guide](docs/compliance/Standards-Citation-Guide.md) -   Checklists: [Standards Checklists](docs/compliance/Standards-Checklists.md)  ## Local Coverage  From this folder, collect, merge, and enforce unified coverage (line ΓëÑ 75%, branch ΓëÑ 60%).  ```pwsh # 1) .NET coverage (Cobertura) dotnet test XCli.sln -c Release --collect:"XPlat Code Coverage" -- `   DataCollectionRunSettings.DataCollectors.DataCollector.Configuration.Format=cobertura  # 2) Python coverage (Cobertura XML) python -m pytest tests --cov=codex_rules --cov-branch --cov-report=xml:coverage-python.xml -q  # 3) Merge to HTML + Cobertura.xml dotnet tool install -g dotnet-reportgenerator-globaltool reportgenerator -reports:"**/coverage.cobertura.xml;coverage-python.xml" `   -targetdir:artifacts/coverage -reporttypes:Cobertura,HtmlInline_AzurePipelines  # 4) Enforce thresholds (uses coverage.xml in CWD) Copy-Item artifacts/coverage/Cobertura.xml coverage.xml python scripts/enforce_coverage_thresholds.py `   --config docs/compliance/coverage-thresholds.json `   --summary artifacts/coverage-summary.md  # Open HTML at artifacts/coverage/index.html ```  Per-file floors live in `docs/compliance/coverage-thresholds.json`. See `docs/compliance/TestStrategy-Coverage.md` for details.  ## CI Tips ### Troubleshooting (PR Comments & Artifacts) - External docs (preferred):   - PR comments (label-gated): https://github.com/LabVIEW-Community-CI-CD/gha-post-pr-comment   - Artifacts metadata loader: https://github.com/LabVIEW-Community-CI-CD/gha-artifacts-metadata - Local fallback (when developing in-repo):   - `.github/actions/post-comment-or-artifact/README.md`   - `.github/actions/load-artifacts-meta/README.md`  ### External Actions CI [![Post Action CI](https://github.com/LabVIEW-Community-CI-CD/gha-post-pr-comment/actions/workflows/post-comment-or-artifact-ci.yml/badge.svg)](https://github.com/LabVIEW-Community-CI-CD/gha-post-pr-comment/actions) [![Artifacts Action CI](https://github.com/LabVIEW-Community-CI-CD/gha-artifacts-metadata/actions/workflows/artifacts-meta-ci.yml/badge.svg)](https://github.com/LabVIEW-Community-CI-CD/gha-artifacts-metadata/actions) [![Post Release](https://github.com/LabVIEW-Community-CI-CD/gha-post-pr-comment/actions/workflows/post-comment-or-artifact-release.yml/badge.svg)](https://github.com/LabVIEW-Community-CI-CD/gha-post-pr-comment/actions) [![Artifacts Releases](https://img.shields.io/github/v/release/LabVIEW-Community-CI-CD/gha-artifacts-metadata?label=gha-artifacts-metadata)](https://github.com/LabVIEW-Community-CI-CD/gha-artifacts-metadata/releases)  Install (Post PR Comment) ```yaml - name: Post telemetry comment (label-gated)   uses: LabVIEW-Community-CI-CD/gha-post-pr-comment@v1   with:     label: telemetry-chunk-diag     comment_path: telemetry/comment.md ```  Install (Load Artifacts Metadata) ```yaml - name: Load artifacts metadata   id: meta   uses: LabVIEW-Community-CI-CD/gha-artifacts-metadata@v1   with:     prefer_cache: true     output_path: telemetry/artifacts_meta.json ```  ## Conveyor Orchestration & Summaries  The repo includes a small multiΓÇærepo ΓÇ£conveyorΓÇ¥ that can orchestrate xΓÇæsdk wrappers, monitor results, and produce consolidated summaries.  ### OneΓÇæshot Orchestration  - Plan only (no dispatch):   - `pwsh -File scripts/dev/orchestrate-multi-repo.ps1 -PlanOnly -Json` - DryΓÇærun (no external runs; records a skipped step):   - `pwsh -File scripts/dev/orchestrate-multi-repo.ps1 -DryRun -Json` - Live (dispatch xΓÇæsdk delegator):   - `pwsh -File scripts/dev/orchestrate-multi-repo.ps1 -XCliRef main -XSdkRef develop -Json`   - If `-XSdkRef main` returns 422 (no `workflow_dispatch`), it autoΓÇæfalls back to `develop` and logs attempts.  Artifacts: `artifacts/multi-repo-run.json` (latest) and `artifacts/multi-repo-run.history.jsonl` (appendΓÇæonly).  ### Monitor + Guard  - Watch a PR until merge then orchestrate:    - `pwsh -File scripts/dev/monitor-delegate.ps1 -XCliPr 123 -OrchestratorVerbose -Json` - Latest merged PR:   - `pwsh -File scripts/dev/monitor-delegate.ps1 -OrchestratorVerbose -Json` - Continuous loop (even without new merges):   - `pwsh -File scripts/dev/monitor-delegate.ps1 -Continuous -LoopMode always -MaxLoops 5 -LoopDelaySeconds 2 -OrchestratorDryRun`  Guarding (nonΓÇæsuccess or problematic steps): - Modes: `-GuardMode off|warn|fail` (default `warn`). - Ignores orchestrator modes in `-GuardIgnoreModes` (default: `plan-only`, `dry-run`). - Triggers when `orchestrator.status != success` or any step is `unknown`/`skipped` (outside ignored modes).  Artifacts: `artifacts/monitor-delegate.history.jsonl` (includes `orchestrator` + `guard`). Each iteration also refreshes: - Markdown: `artifacts/conveyor-summary.md` - JSON: `artifacts/conveyor-summary.json`  ### Consolidated Summaries  - PowerShell wrapper (markdown + JSON):   - `pwsh -File scripts/dev/conveyor-summary.ps1`   - Options: `-Count 20`, `-TimeFmt local|utc|relative`, `-JsonOut artifacts/conveyor-summary.json`.   - Defaults: local runs ΓåÆ relative time; CI ΓåÆ UTC. - Direct JSON:   - `python scripts/dev/conveyor_summary.py --json`  Summaries include aggregates, recent items, fallback notes (requestedΓåÆeffective with attempt exit codes), and latest guard state. Footer prints the generation timestamp/mode and the number of entries summarized.  ### Makefile Shortcuts  - `make conveyor`          # Markdown + JSON (local default: relative time) - `make conveyor-utc`      # Markdown + JSON in UTC - `make conveyor-json`     # JSON only - `make monitor-run ARGS=" -XCliPr 123 -OrchestratorVerbose -GuardMode warn -Json"` - `make monitor-run ARGS=" -Continuous -LoopMode always -MaxLoops 5 -LoopDelaySeconds 2 -OrchestratorDryRun"` - `make orchestrate-run ARGS=" -XCliRef main -XSdkRef develop -Json"`  ### Tips  - Live dispatches require `gh auth status` (authenticated) and repo access; set `XCLI_PAT` for crossΓÇærepo/private. - To reduce local hook noise: set `XCLI_DISABLE_GIT_HOOKS=1` (or `DISABLE_GIT_HOOKS=1`) or create `.codex/disable-hooks`.  ## Container Usage  - Images live at `ghcr.io/labview-community-ci-cd/x-cli:<version>` (semantic tags, shas, or `latest`). - Run the container directly, e.g. `docker run --rm ghcr.io/labview-community-ci-cd/x-cli:latest --help` or `--version`. - Each publish workflow generates an SPDX SBOM (uploaded as an artifact) and pushes a build-provenance attestation alongside the image in GHCR.  - Keep workflow YAML comments/messages ASCII-only. Emojis or non-ASCII glyphs can cause decode errors on Windows-local checks. Prefer plain text equivalents (e.g., use 'PASS/FAIL' instead of symbols).  > **Architecture Packet:** see [`docs/architecture/README.md`](docs/architecture/README.md) > **Templates:** SRS ┬╖ SCMP ┬╖ Test Plan ΓÇö see [`docs/templates/`](docs/templates/)  [![Docs Link Check](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/docs-gate.yml/badge.svg)](./.github/workflows/docs-gate.yml) [![PR Coverage Gate](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/coverage-gate.yml/badge.svg)](./.github/workflows/coverage-gate.yml) [![Traceability Gate](https://github.com/LabVIEW-Community-CI-CD/x-cli/actions/workflows/srs-gate.yml/badge.svg)](./.github/workflows/srs-gate.yml)  > **Docs templates:** [RTM (1ΓÇæpager)](docs/templates/RTM-template.md) ┬╖ [RTM (YAML)](docs/templates/RTM-yaml-template.yaml) ┬╖ [Release Audit Checklist (FCA/PCA)](docs/templates/Release-Audit-Checklist.md) ┬╖ [Release Audit Record](docs/templates/Release-Audit-Record.md)  ## ghops JSON Logs (Dashboards)  - CI emits machine-readable logs for GitHub-CLI helper runs:   - Unified: `ghops-logs-all/all-logs.json` (schema `ghops.logs/v1`)   - Quick glance: `ghops-logs-all/quick-glance.json` (top tasks/commands; dashboard-friendly)   - Human summary: `ghops-logs-all/comment.md` - Schemas and examples live under `docs/schemas/ghops-logs.md`. - Local summarize:   - `powershell -File scripts/ghops/tools/all-logs-summary.ps1 -Input ghops-logs-all/all-logs.json`   - JSON: add `-Json` and redirect to a file for automation.  ## Container Usage (Local)  - POSIX: `./scripts/build-container.sh x-cli:dev` (packs the CLI as a `.nupkg` and builds the image from the package) - Windows: `pwsh ./scripts/build-container.ps1 -Tag x-cli:dev` - Build from source fallback: `docker build --target source-image -t x-cli:dev .`  ## Log Replay & Diff  - Replay a historic run: `dotnet run -- log-replay --from path/to/run.jsonl --max-delay-ms 0` - Emit timing deltas: `dotnet run -- log-diff --baseline runs/baseline.jsonl --candidate runs/new.jsonl --format text` - JSONL schema: each line has `t` (delay ms), `s` (stdout/stderr), `m` (message). Optional fields (`test`, `meta`) are ignored by replay but surfaced in diffs. - `--strict` makes replay fail on malformed lines; `--stdout-only` forces messages to stdout.  ## Telemetry CLI  - Summarize QA telemetry into a JSON snapshot and optional history line:   - `dotnet run -- telemetry summarize --in artifacts/qa-telemetry.jsonl --out telemetry/summary.json --history telemetry/qa-summary-history.jsonl` - Notes   - Input: `artifacts/qa-telemetry.jsonl` (written by the QA pipeline).   - Output: `telemetry/summary.json` plus `telemetry/qa-summary-history.jsonl` when `--history` is provided.   - Uses `GITHUB_RUN_ID` (when set) to annotate history records.   - This command is integrated in `scripts/qa.ps1` as `qa-telemetry-summarize` and is safe to run locally.  ## Publishing Locally  - Ensure you are on `main` (the Makefile guard blocks pushes from other branches unless `ALLOW_NON_MAIN=1`). - Push a dev tag to GHCR using your current Docker login:   - `make release-dev IMAGE_NAME=ghcr.io/<owner>/x-cli` - Push a version tag and also update `latest`:   - `make release-latest IMAGE_NAME=ghcr.io/<owner>/x-cli TAG=vX.Y.Z`   - If `TAG` is omitted, the Makefile derives it from the latest git tag (e.g., `git describe --tags`).   - SemVer is enforced: `vMAJOR.MINOR.PATCH[-PRERELEASE][+BUILD]` (e.g., `v1.2.3`, `v1.2.3-rc.1`).   - Set `ALLOW_NON_MAIN=1` to bypass the branch guard if needed (not recommended).   ## Publishing Locally  - Login to GHCR (once): `echo $GHCR_TOKEN | docker login ghcr.io -u $GHCR_USER --password-stdin` - Build + push dev tag: `make release-container IMAGE_NAME=ghcr.io/<owner>/x-cli TAG=dev-$(git rev-parse --short HEAD)` - Push latest too: `PUSH_LATEST=1 make release-container IMAGE_NAME=ghcr.io/<owner>/x-cli TAG=vX.Y.Z`  ## CI Helpers  See docs/ci-helpers.md for a quick index of ghops wrappers, RTM JSON outputs, schemas, and validation steps. Schema list lives in docs/schemas/README.md. For Node-based tools (TypeScript utilities, JSON generators), follow the reproducible patterns in [docs/ci/node-patterns.md](docs/ci/node-patterns.md).

